import rollupUglify from 'rollup-plugin-uglify';
import rollupCommonjs from 'rollup-plugin-commonjs';
import rollupResolve from 'rollup-plugin-node-resolve';
import rollupTypescript from 'rollup-plugin-typescript';
import rollupSourcemaps from 'rollup-plugin-sourcemaps';

export default {
    input: './global-script.ts',
    plugins: [
        rollupTypescript({
            typescript: require('typescript')
        }),
        rollupUglify(),
        rollupResolve(),
        rollupCommonjs(),
        rollupSourcemaps()
    ],
    output: {
        file: 'dist/global{{packName}}.min.js',
        format: 'iife',
        name: 'ej',
        intro: `window.process = { env: { NODE_ENV: 'production' } }`,
        footer: `
        this.ejs = ej;
        // Global Module Export
        if ( typeof module === "object" && typeof module.exports === "object" ) {
            module.exports = {ej:ej};
        } 
        //AMD Module Export
        if ( typeof define === "function" && define.amd ) {
	        define( "ej", [], function() {
		        return {ej:ej};
	        } );
        }
        `,
        sourcemap: false
    }
};
